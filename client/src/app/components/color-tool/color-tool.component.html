<div class="row form-inline">
  <small class="col-md-7 ">Primaire</small>
  <div class="col-md-4 form-control form-control-sm clickable p-0" style="background-color:white;"
    (click)="colorPrimarySelected();openModal()" placement="top" ngbTooltip="Changer">
    <div style="width:100%;height:100%" class="form-control form-control-sm"
      [style.background-color]="rgbaPrimaryColor.asString()"></div>
  </div>
</div>
<div class="row form-inline mt-2">
  <small class="col-md-7 ">Transparence</small>
  <input #alpha1 id="primaryAlpha" class="col-md-4 form-control form-control-sm alpha-input" type="number" step="0.01"
    min="0" max="1" [(ngModel)]="primaryAlpha" (click)="validateAlpha()" (focusout)="validateAlpha()"
    (input)="validateAlpha()">
  <input type="range" class="custom-range col-md-10 offset-1" [(ngModel)]="primaryAlpha" (input)="validateAlpha()"
    min="0" max="1" step="0.01">
</div>
<div class="row mt-1">
  <button style="font-size:10px;" (click)="setBackgroundColor()"
    class="btn btn-secondary btn-sm col-md-5 offset-md-1 p-0" placement="top"
    ngbTooltip="Changer la couleur de fond">Couleur de fond</button>
  <button style="font-size:10px;" id="switch" (click)="switchColor()"
    class="btn btn-secondary btn-sm col-md-4 offset-md-1 p-0" placement="top"
    ngbTooltip="Inverser les couleurs">↑↓</button>
</div>

<div class="row form-inline mt-3">
  <small class="col-md-7 ">Secondaire</small>
  <div class="col-md-4 form-control form-control-sm clickable p-0" style="background-color:white;"
    (click)="colorSecondarySelected();openModal()" placement="top" ngbTooltip="Changer">
    <div style="width:100%;height:100%" class="form-control form-control-sm"
      [style.background-color]="rgbaSecondaryColor.asString()"></div>
  </div>
</div>
<div class="row form-inline mt-2">
  <small class="col-md-7 ">Transparence</small>
  <input #alpha2 id="secondaryAlpha" class="col-md-4 form-control form-control-sm alpha-input" type="number" step="0.01"
    min="0" max="1" [(ngModel)]="secondaryAlpha" (click)="validateAlpha()" (focusout)="validateAlpha()"
    (input)="validateAlpha()">
  <input type="range" class="custom-range col-md-10 offset-1" [(ngModel)]="secondaryAlpha" (input)="validateAlpha()"
    min="0" max="1" step="0.01">
</div>

<div class="row form-inline mt-3">
  <small class="col-md-12 ">Précédentes couleurs</small>

</div>
<div class="row p-1 mt-1 ">
  <svg width="100%" height="73">
    <rect class="clickable border m-0" *ngFor="let lastColor of lastColorsUsed" [attr.x]="lastColor.positionX"
      [attr.y]="lastColor.positionY" width="18%" height="45%" [attr.fill]="lastColor.color"
      (click)="getStackColor($event)"></rect>
  </svg>
</div>

<ng-template #paletteModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="exampleModalLabel">Choix de couleur</h5>
  </div>
  <form [formGroup]="paletteForm" (ngSubmit)="applyClickedColor(paletteForm);closeModal();">
    <div class="modal-body">
      <div class="row">
        <div class="col-md-12">
          <label>Aperçu: </label>
          <svg width="30" height="30">
            <circle id="currentColor" cx="15" cy="15" r="10" [attr.fill]="currentHexSelectedColor"
              [attr.fill-opacity]="currentAlpha" />
          </svg>
        </div>
      </div>
      <div class="row">
        <div class="col-md-2">
          <label>Palette:</label>
        </div>
        <div class="col-md-10">

          <svg id="palette" width="300" height="200">
            <rect *ngFor="let choice of paletteChoices" [attr.x]="choice.positionX" [attr.y]="choice.positionY"
              width="50" height="50" [attr.fill]="choice.color" (click)="getClickedColor($event)"></rect>
          </svg>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-md-12">
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text left-form-group">RGB</span>
            </div>
            <div class="form-inline">
              <input class="form-control center-form-group" name="red" formControlName="red" type="number" min="0"
                max="255" (input)="confirmRGBColor()" (click)="confirmRGBColor()" (focusin)="setActiveFocus()"
                (focusout)="confirmRGBColor(); setInactiveFocus()">
              <input class="form-control center-form-group " name="green" formControlName="green" type="number" min="0"
                max="255" (input)="confirmRGBColor()" (click)="confirmRGBColor()" (focusin)="setActiveFocus()"
                (focusout)="confirmRGBColor(); setInactiveFocus()">
              <input class="form-control center-form-group" name="blue" formControlName="blue" type="number" min="0"
                max="255" (input)="confirmRGBColor()" (click)="confirmRGBColor()" (focusin)="setActiveFocus()"
                (focusout)="confirmRGBColor(); setInactiveFocus()">
            </div>
          </div>
        </div>
      </div>



      <div class="input-group mb-3" id="hexGroup">
        <div class="input-group-prepend">
          <span class="input-group-text left-form-group">HEX</span>
        </div>
        <input name="hex" formControlName="hex" class="form-control" type="text" (focusin)="setActiveFocus()"
          (input)="confirmHexColor();" (focusout)="confirmHexColor(); setInactiveFocus()" maxlength="6"
          aria-describedby="applyHex">
      </div>

      <div class="alert alert-danger" *ngIf="hexError || rgbaError">Valeurs erronées</div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline-dark" (click)="closeModal()">Annuler</button>
      <button class="btn btn-outline-success" [disabled]="hexError || rgbaError">Appliquer</button>
    </div>
  </form>
</ng-template>